{
id: "mushroom_jellyfish_spawner",
prototype: ["stationary_vulnerable"],
has_feet: false,
hitpoints: 200,
tmp: {
	anim_repeat: 0,
},
vars: {
	load: 0,
	spawned_objects: [],
	max_objects: 3,
},
consts: {
	basic_type: "mushroom_jellyfish_spawner",
	frogourmet_tag: "mushroom_jellyfish_spawner",
},
properties: {
	handle_knockback: "def(collide_with) null",
	points_value: 7,
	normal_repeat: 0,
	chargeup_repeat: 0,
	
	should_shoot: "(spawned_objects.size < max_objects)",
	cull_dead_spawnees: "def() set(spawned_objects, filter(spawned_objects, value.hitpoints > 0 and value.mid_x > vars.zone_x1 and value.mid_x < vars.zone_x2 and value.mid_y > vars.zone_y1 and value.mid_y < vars.zone_y2))",
},
on_end_normal_anim: "if(tmp.anim_repeat > normal_repeat and should_shoot, [animation('prepare'), set(tmp.anim_repeat, 0)], [animation('normal'), add(tmp.anim_repeat, 1)])",
on_end_prepare_anim: "animation('chargeup')",
on_end_chargeup_anim: "if(tmp.anim_repeat > chargeup_repeat, [animation('shoot'), set(tmp.anim_repeat, 0)], [animation('chargeup'), add(tmp.anim_repeat, 1)])",
on_end_shoot_anim: "animation('normal')",

timer_frequency: 5,
on_timer:  "cull_dead_spawnees()",

on_shoot: "[
		sound('pollen-shot.wav'),
		add_object(obj),
		set(obj.velocity_y, 500*upside_down-500),
		add(vars.spawned_objects, [obj]),
		set(obj.vars.init_x, me.mid_x + 1d400-200),
		set(obj.vars.init_y, me.mid_y + 1d400-500),
		set(obj.vars.desired_height, me.mid_y + 1d400-500),
		set(obj.vars.x_bound, me.zone_x1 + 150),
		set(obj.vars.x2_bound, me.zone_x2 - 150),
		set(obj.vars.dive_height, me.mid_y + 100),
		set(obj.vars.behavior, 'climb'),
		
		
		] where obj = object(
		'mushroom_jellyfish', 
		midpoint_x, 
		midpoint_y, 
		facing, 
		)",
		
solid_area: [4,13,23,27],
editor_info: {
	category: "enemies, forest",
	var: [
		{
			name: "max_objects",
			value: 3,
		},
		{
			name: "zone_x1",
			type: "x",
			value: "x - 500",
		},
		{
			name: "zone_x2",
			type: "x",
			value: "x + 600",
		},
		{
			name: "zone_y1",
			type: "y",
			value: "y - 600",
		},
		{
			name: "zone_y2",
			type: "y",
			value: "y + 600",
		},
	],
},
animation: [
	{
		"@base": true,
		no_remove_alpha_borders: true,
		image: "enemies/mushroom-jellyfish-launcher.png",
		pad: 3,
		accel_y: 0,
		body_area: "all",
		
	},
	{
		id: "normal",
		duration: 24,
		frames: 1,
		frames_per_row: 4,
		rect: [2,2,55,60],
	},
	{
		id: "hurt",
		frames: 1,
		duration: 18,
		rect: [2,2,55,60],
	},
	{
		id: "shoot",
		rect: [2,2,55,60],
		reverse: false,
		frames: 1,
		duration: 8,
		events: "2:shoot",
	},
	{
		id: "chargeup",
		duration: 8,
		frames: 1,
		rect: [2,2,55,60],
	},
	{
		id: "prepare",
		duration: 12,
		frames: 1,
		rect: [2,2,55,60],
	},
],

}
