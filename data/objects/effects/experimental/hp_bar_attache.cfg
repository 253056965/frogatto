{
	id: "hp_bar_attache",
	is_strict: true,
	zorder: "@include data/zorder.cfg:in_front_of_everything",
	always_active: true,
	solid_dimensions: [],

	editor_info: {
		category: "aaa",
	},

	properties: {
		fraction_of_hitpoints: "decimal :: 0.333", //this will be whatever the actual creature's hp is.
	},

	on_create: "[
		[fire_event(evt) | evt <- [
			'set_background', 
		]], 
	]",

	on_set_background: "[
		(
		set(me.animation, {
			id: 'fbo', 
			image: 'fbo', 
			pivot_origin: [0,0],
			blend: ['src_color','one_minus_src_alpha'],

			fbo: c.render(bar_width,bar_height+1, (
		
			[[
				c.set_source_rgba(0,1,0, 1.0), 
				c.rectangle(px,py,1,1), 
				c.fill(),
				] | px <- range(bar_width),
					py <- range(bar_height)
			] + [[ //render red portion
				c.set_source_rgba(0,0,0, 1.0), 
				c.rectangle(px,py,1,1), 
				c.fill(),
				] | px <- range(bar_width - proportional_width, bar_width),
					py <- range(bar_height)
			] + [[ //render shadow
				c.set_source_rgba(0,0,0, 0.2), 
				c.rectangle(px,py,1,1), 
				c.fill(),
				] | px <- range(bar_width),
					py <- [bar_height]
			]
			
			)),
				 
			x:0, y:0, w:bar_width, h:bar_height+1,
			scale: 2,
		})
			where c = canvas(),
			where	proportional_width = lib.math.round(bar_width * fraction_of_hitpoints),
			where	bar_width = 32,
					bar_height = 3,
		),
	]",
}