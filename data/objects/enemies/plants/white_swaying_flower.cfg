{
id: "white_swaying_flower",
prototype: ["movable_enemy"],
solid_dimensions: ["enemy","common"],
editor_info: {
	category: "enemies, forest",
},
properties: {

	_segments: { type: "[obj white_swaying_flower.segment]", default: [] },

	create_segments: "[set(_segments, new_set_of_segments), schedule(1, bind_command(def() map(_segments, [value.attach_to_spawner, add_object(value)] )))]
			where new_set_of_segments = map(range(6), object('white_swaying_flower.segment',midpoint_x,midpoint_y,{facing: facing, _forced_parent_ref: me}))",

	position_segments: "map(_segments,  [set(value.mid_x, new_pos.x), set(value.mid_y, new_pos.y)]
							where new_pos = individual_segment_position(index)
						)",
						
	individual_segment_position: "def(int s_index) -> {x: decimal, y: decimal}
							{	
								x: img_mid_x + (13.0 * sin(cycle*5.5 + spacing * s_index) * fraction),
								y: img_mid_y - (18 * s_index)
							}
								where spacing = decimal :: ( 360 / size(_segments) )
								where fraction = decimal :: (s_index + 1.0) / size(_segments)"
},

on_create: "create_segments",

on_process: "position_segments",

animation: [
	{
		id: "normal",
		image: "enemies/white-shooting-flower.png",
		body_area: "all",
		accel_y: 0,
		rect: [76,5,120,49],
	},
],

object_type: {
	id: "segment",
	prototype: ["hittable_attache"],
	animation: [
		{
			image: "enemies/white-shooting-flower.png",
			id: "normal",
			duration: 60,
			rect: [6,5,24,23],
			frames: 1,
			body_area: null,
		},
	],
},
}

