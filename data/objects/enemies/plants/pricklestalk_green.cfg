{
id: "pricklestalk_green",
prototype: ["ant"],
editor_info: {
	category: "enemies, seaside",
},
solid_area: [10,18,25,33],

properties: {
	taxonomy: "'plant'",
	spike_offset: "def(decimal angle_offset) -> {x: decimal, y: decimal} {x: mid_x + offset[0], y: mid_y + offset[1]} where offset = orbit(0, 0, self.rotate - 90 + angle_offset, mid_y-10-y)",
	spike_speed: "500",
	spike_vel: "def(decimal angle_offset) -> {x: decimal, y: decimal} {x: spike_speed * cos(angle_offset + self.rotate - 90), y: spike_speed * sin(angle_offset + self.rotate - 90)}",
	spawn_individual_spike: "def(decimal angle_offset) -> commands spawn('${type}.spike', spike_offset(angle_offset).x, spike_offset(angle_offset).y, {rotate: angle_offset, velocity_x: spike_vel(angle_offset).x, velocity_y: spike_vel(angle_offset).y})",
	
	fire_spikes: "[spawn_individual_spike(-85), spawn_individual_spike(-45), spawn_individual_spike(0), spawn_individual_spike(45), spawn_individual_spike(85) ]",
	
	physical_size: "32",
	
#-------------------------- vars --------------------------#
	attack_counter: { type: "int", default: 0 },
},

hitpoints: 200,

on_end_anim: "[if(animation in ['stand', 'walk', 'turn', 'hurt', 'spring'],
					switch(1d5,
						1, animation('attack'),
						2, turn_around,
						3, animation('stand'),
						4, animation('stand'),
						animation('walk') )
					)]",

on_end_attack_anim: "animation('stand')",
on_shoot: "fire_spikes",

on_process_stand: "/*null out prototype behavior that'd normally force us to start walking*/",

on_timer: "[set(rotate, slope_standing_on/3), if(is_standing and animation in ['walk','run'] and (should_turn_away_from_cliff or should_turn_towards_player),turn_around,null)]",

animation: [

	{
		"@base": true,
		image: "enemies/pricklestalk-green.png",
		pad: 3,
		accel_x: 0,
		accel_y: 80,
		body_area: "all",
		attack_area: "all",
	},
	{
		id: "stand",
		rect: [1,85,38,122],
		frames: 5,
		reverse: true,
		duration: 5,
	},
	{
		id: "hurt",
		rect: [1,85,38,122],
		frames: 1,
		duration: 15,
	},
	{
		id: "turn",
		rect: [1,85,38,122],
	},
	{
		id: "spring",
		rect: [1,85,38,122],
	},
	{
		id: "walk",
		rect: [1,1,38,38],
		frames: 8,
		frames_per_row: 4,
		accel_x: 160,
		duration: 5,
	},
	{
		id: "walk",
		rect: [1,1,38,38],
		frames: 8,
		frames_per_row: 4,
		accel_x: 320,
		duration: 4,
	},
	{
		id: "attack",
		rect: [1,128,38,165],
		frames: 8,
		frames_per_row: 4,
		duration: 4,
		events: "16:shoot",
	},
],
object_type: [
	{
		id: "spike",
		dies_on_inactive: true,
		timer_frequency: 50,
		object_level_collisions: true,
		solid_dimensions: ["player"],
		prototype: ["shot"],
		properties: {
			attack_damage: "if(higher_difficulty,2,1)",
		},
		on_end_normal_anim: "animation('normal')",
		on_timer: "die()",
		animation: [
			{
				image: "enemies/pricklestalk-green.png",
				attack_area: "all",
				accel_y: 00,
				pad: 3,
				id: "normal",
				rect: [171,1,187,17],
				duration: -1,
			},
		],
	},
	]
}