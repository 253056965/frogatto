{
id: "gazer_boss",
prototype: ["hittable"],
always_active: true,
editor_info: {
	category: "boss",
},

properties: {
	attack_damage:  "if(true, kill_anything, 0)",
	team:  			"if(true, 'evil', 'evil_harmless')",
	
	title: "~Gazer Boss~",
	description: "~When you stare into The Great Eye, it also stares into you!  And fires death beams at you, because eyes totally do that sometimes.  Honest.~",
	taste: "~AHA!~",


	set_behavior: "def(string choice) -> commands execute(me, [switch(choice,
					'attack_laser', begin_laser,
		), set(me.behavior, choice)])",
		
	begin_laser: "commands :: [spawn('gazer_boss.beam', mid_x, mid_y, {parent: me})]",
	
	custom_damage_table: "{
		neutral: 1.0,
		fire: 1.0,
		energy: 0.5,
		arcane: 0.25,
		acid: 0.0,
		impact: 0.0,
		impale: 1.0,
		lacerate: 1.0
	}",
	
	
							
								
#--------------------------  vars --------------------------#
	behavior: { type: "string", default: "", persistent: false },
},
		
on_create:  "set_behavior('attack_laser')",

on_process: "add(rotate, 1)",

animation: [
{
	"@base": true,
	image: "enemies/gazer-boss1.png",
	attack_area: "all",
	body_area: "all",
	no_remove_alpha_borders: true,
},
{
	id: "normal",
	rect: [1,1,125,125],
	frames:1,
	duration: 10,
},
],

object_type: [
	{
		id: "beam",
		always_active: true,
		serializable: false,
		zorder: 20,
		
		properties: {
			texture_offset: "0",
			beam_length: "400",
			
			draw_w: "img_w/2",
			pupil_offset: "64.0",
			width_coefficient: "img_w/pupil_offset * (decimal(0.5*img_h)/img_w)", //<- this is some black magic, here.   
			
			beam_angle: "parent.rotate - (90 - 1) asserting parent != null",

			offset: "{ x: decimal, y: decimal } :: { x: length * cos(beam_angle)  ,
													 y: length * sin(beam_angle) - (beam_length - (width_coefficient) * pupil_offset)} where length = (pupil_offset + beam_length)", 

			//for 64w 128h
			//48 => (beam_length - 1.25 * pupil_offset)
			//32 => (beam_length - 2.0 * pupil_offset)
			//24 =>  2.75???
			//16 =>  4
			
			//		for 128w 128h  (values are 2x) ...  we need to extract a 2:1 ratio here...  img_w:img_h is just 1:1.  draw_w:img_h is 0.5:1 or 1:2, the inverse.
			//															img_w:2
			//1.0	128 => 0.5 * pupil_offset
			//2.0	64 => 1.0 * pupil_offset
			//2.66	48 => (beam_length - 1.25 * pupil_offset)
			//4.0	32 => (beam_length - 2.0 * pupil_offset)
			
			
			// for 256w 128h these are just doubled, again. (4x)  
			
			// for 256 64h these are doubled again, again (8x)
			

		},
		
		
		on_process: "[	debug(decimal(0.5*img_h)/img_w),
						//debug(draw_w/decimal(img_h)),
						set(relative_x, offset.x),
						set(relative_y, offset.y),
						set(rotate, parent.rotate),
						set(draw_area, [0, texture_offset, draw_w, beam_length])
		
					] asserting parent != null",
		
		animation: [{
			id: "normal",
			image: "enemies/gazer-boss-beam.png",
			rect: [0,0,31,63],
			frames:1,
			duration: 10,
			no_remove_alpha_borders: true,
		}],

	}
],

}